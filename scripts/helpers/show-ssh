#!/usr/bin/env bash

set -e

priv_key=$1
config=$2

echo "To access the cluster node(s) via ssh:"
echo
vmcnt=$(yq '.vms | length' $config)
for ((i = 0; i < $vmcnt; ++i)); do
  node=$(yq .vms[$i].name $config)
  ip=$(xec get-vm-ip $node)
  echo "$node: ssh -i $priv_key root@$ip"
done
