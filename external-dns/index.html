
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://aceeric.github.io/desktop-kubernetes/external-dns/">
      
      
        <link rel="prev" href="../add-ons/">
      
      
        <link rel="next" href="../components-and-versions/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>External DNS - Desktop Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#external-dns-integration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Desktop Kubernetes" class="md-header__button md-logo" aria-label="Desktop Kubernetes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desktop Kubernetes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              External DNS
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aceeric/desktop-kubernetes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Desktop Kubernetes" class="md-nav__button md-logo" aria-label="Desktop Kubernetes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Desktop Kubernetes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aceeric/desktop-kubernetes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../command-line/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Command Line
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../add-ons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Add-Ons
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    External DNS
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    External DNS
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How it works
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-ingress" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example Ingress
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-webook-server-by-hand" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Webook Server by hand
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restarting-the-webook-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Restarting the Webook Server
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        Install script
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../components-and-versions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Components and Versions
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../conformance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Conformance
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How it works
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-ingress" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example Ingress
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-webook-server-by-hand" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Webook Server by hand
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restarting-the-webook-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Restarting the Webook Server
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        Install script
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="external-dns-integration">External DNS Integration<a class="headerlink" href="#external-dns-integration" title="Permanent link">&para;</a></h1>
<p>In a typical corporate environment, when a Kubernetes cluster is provisioned using IaC for example, DNS is usually configured as part of cluster provisioning.</p>
<p>On the desktop we can't modify DNS to route <code>abc.com</code> to the Kubernetes cluster VMs running on your local host. But a simple way to accomplish this is to update <code>/etc/hosts</code> with such an entry. But it's tedious to do that by hand whenever a new Ingress resources is deployed. So DTK has the ability to automate updating <code>/etc/hosts</code> to add Ingress host names when a new Ingress resource is created in the cluster. Since everything is running right on your desktop, this is a completely reasonable approach, despite being low-tech.</p>
<p>DTK implements this using two components:</p>
<ol>
<li>The <a href="https://github.com/kubernetes-sigs/external-dns">External DNS</a> add-on.</li>
<li>A Python HTTP server included in the project repo that implements the External DNS <strong>webhook provider</strong> interface (and a couple additional methods.) The External DNS Add-On installer will configure the External DNS workload in the cluster to call out to this Python server.</li>
</ol>
<blockquote>
<p>For details on External DNS's webhook design, see <a href="https://kubernetes-sigs.github.io/external-dns/v0.18.0/docs/tutorials/webhook-provider/#exposed-endpoints">their documentation</a>.</p>
</blockquote>
<p>The steps described in this guide assume you are running the Python HTTP server found in the <code>hostsfile-server</code> directory of DTK - either as a <code>systemd</code> service (which is how I run it) or just from the command line while you're provisioning and running your cluster. Details on this are provided further down in this document.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Since the External DNS workload running inside the Kubernetes cluster within a VM on your desktop will be making HTTP calls to the Python HTTP server running outside the VM on your desktop you <strong>might</strong> need to configure firewall rules on your desktop to allow that traffic in to your host from the guest(s).</p>
<p>On my Ubuntu desktop, for example, I use <em>Gufw</em> and I have a global rule to allow traffic into my desktop from the same network. When KVM creates the VMs, it uses DHCP on my home network to assign an IP address in same CIDR block as my desktop. Your environment might differ.</p>
</div>
<h2 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Permanent link">&para;</a></h2>
<p>The sequence diagram illustrates the design:</p>
<pre class="mermaid"><code>sequenceDiagram
    developer-&gt;&gt;desktop-kubernetes: 1: Create cluster
    desktop-kubernetes-&gt;&gt;hostsfile-server.py: 2: Manage domain 'dtk.io'
    desktop-kubernetes-&gt;&gt;kubernetes: 3: Install external-dns with webhook provider
    kubernetes-&gt;&gt;external-dns: 4: Create workload
    external-dns-&gt;&gt;hostsfile-server.py: 5: Get domains
    hostsfile-server.py-&gt;&gt;external-dns: 6: 'dtk.io'
    developer-&gt;&gt;kubernetes: 7: Create Ingress with host 'foo.dtk.io'
    external-dns-&gt;&gt;kubernetes: 8: Watch Ingress
    external-dns-&gt;&gt;external-dns: 9: Read Ingress domain
    external-dns-&gt;&gt;hostsfile-server.py: 10: 'foo.dtk.io' was added
    hostsfile-server.py-&gt;&gt;/etc/hosts: 11: Update
    developer-&gt;&gt;kubernetes: 12: curl https://foo.dtk.io</code></pre>
<p>Narrative:</p>
<ol>
<li>When you create a new Kubernetes cluster you enable the <code>external-dns</code> Add-On, and you configure External DNS integration using the <code>dns</code> section of the <code>config.yaml</code>. Example:
   <div class="highlight"><pre><span></span><code>dns:
  domain: dtk.io
  host-ip: 192.168.0.12
  webhook-port: 5000
</code></pre></div>
   The yaml entries are:<ol>
<li><code>domain: dtk.io</code>: Defines the list of managed domains. Only those domains will be managed in <code>/etc/hosts</code> by the Python HTTP server. All other domains will be ignored.</li>
<li><code>host-ip: 192.168.0.12</code>: Your desktop IP address.</li>
<li><code>webhook-port: 5000</code>: The port you're running the Python HTTP server on. The desktop IP address and this port are templated into the External DNS Helm values when it is installed by DTK. That's how External DNS inside the cluster can call the Python HTTP server running on your desktop.</li>
</ol>
</li>
<li>DTK sends the specified domain (<code>dtk.io</code> in this case) and the IP address of the Kubernetes controller VM to the Python HTTP server. The server stores these.</li>
<li>DTK installs <code>external-dns</code>, either because you uncommented it in the <code>addons</code> list in <code>config.yaml</code>, or you explicitly installed it with <code>./dtk install-addon external-dns</code>. As part of this step, your host IP and webhook port are templated into the <code>external-dns</code> Helm values.</li>
<li>Kubernetes creates the <code>external-dns</code> workload.</li>
<li>When <code>external-dns</code> starts it sees that it is configured to integrate with the <code>webhook</code> provider so it calls the webhook (the Python HTTP server) to get a list of managed domains.</li>
<li>The Python HTTP server replies with <code>dtk.io</code>.</li>
<li>You (the developer) create an Ingress with one of the rules specifying host <code>foo.dtk.io</code> <strong>and</strong> with an annotation that External DNS understands. (There is an example ingress below showing the annotation.)</li>
<li>External DNS watches Ingresses.</li>
<li>External DNS reads the host name from the Ingress annotation.</li>
<li>External DNS sends the host name to the webhook (the Python HTTP server.)</li>
<li>The Python HTTP server updates <code>/etc/hosts</code>.</li>
<li>You can now curl https://foo.dtk.io (or <code>http</code> depending on how you configured the Ingress.)</li>
</ol>
<h2 id="example-ingress">Example Ingress<a class="headerlink" href="#example-ingress" title="Permanent link">&para;</a></h2>
<p>Observe that the annotation below has the same host name as the <code>host</code> in the <code>rules</code> list:  <code>foo.dtk.io</code>:</p>
<div class="highlight"><pre><span></span><code>cat &lt;&lt;EOF | kubectl -n default apply -f -
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    external-dns.alpha.kubernetes.io/target: foo.dtk.io
  name: test
spec:
  ingressClassName: nginx
  rules:
  - host: foo.dtk.io
    http:
      paths:
      - backend:
          service:
            name: test
            port:
              number: 80
        path: /
        pathType: Prefix
EOF
</code></pre></div>
<h2 id="running-the-webook-server-by-hand">Running the Webook Server by hand<a class="headerlink" href="#running-the-webook-server-by-hand" title="Permanent link">&para;</a></h2>
<p>If you don't want to install the webook as a <code>systemd</code> service you can just run it while you're running the Kubernetes cluster that is running the External DNS Add-On. The <code>external-dns</code> install script initializes the webhook server from the <code>config.yaml</code> when it installs the Add-On. So you can run the server manually before installing the Add-On. Run as <code>sudo</code> because the process updates <code>/etc/hosts</code>:</p>
<div class="highlight"><pre><span></span><code>sudo hostsfile-server/hostsfile-server.py
</code></pre></div>
<h2 id="restarting-the-webook-server">Restarting the Webook Server<a class="headerlink" href="#restarting-the-webook-server" title="Permanent link">&para;</a></h2>
<p>If you stop the server, it loses all its state. You can restart it with the configuration that it would normally receive from the <code>external-dns</code> Add-On install script. E.g.:</p>
<div class="highlight"><pre><span></span><code>sudo hostsfile-server/hostsfile-server.py\
  --cluster-ip=192.168.122.167\
  --port=5000\
  --domains=dtk.io,mydomain.io
</code></pre></div>
<p>In the example above, the <code>192.168.122.167</code> ip address is the address of the controller node VM. This is the IP address that gets interpolated into <code>/etc/hosts</code> whenever a new host name is received by the webhook from External DNS.</p>
<h2 id="install-script">Install script<a class="headerlink" href="#install-script" title="Permanent link">&para;</a></h2>
<p>When you install the <code>external-dns</code> Add-On either by enabling it in the <code>config.yaml</code> or manually via <code>--install-addon external-dns</code> the install script does the following:</p>
<ol>
<li>Reads <code>dns.host-ip</code> and <code>dns.webhook-port</code> from configuration.</li>
<li>Configures the External DNS Helm chart with these values.</li>
<li>Reads <code>dns.domain</code> from configuration and gets the IP address of the cluster control plane VM.</li>
<li>Configures the running webhook server with these values using REST calls.</li>
</ol>
<p>Therefore you must edit the <code>config.yaml</code> before installing the Add-On with values that make sense for your environment.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../add-ons/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Add-Ons">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Add-Ons
              </div>
            </div>
          </a>
        
        
          
          <a href="../components-and-versions/" class="md-footer__link md-footer__link--next" aria-label="Next: Components and Versions">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Components and Versions
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.footer"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>